{% extends 'KRSolutionsKRCMSBundle::layout.html.twig' %}

{% block title %}{{ 'site.index.header.sites'|trans({}, 'KRSolutionsKRCMSBundle') }} - Content Management Systeem{% endblock %}

{% block header %}
	<div class="col-lg-8">
		<h1 class="page-header">{{ 'site.index.header.sites'|trans({}, 'KRSolutionsKRCMSBundle') }}</h1>
	</div>
	<div class="col-lg-4">
		<div class="page-header-buttons pull-right">
			<a href="{{ path('kr_solutions_krcms_sites_add') }}" class="btn btn-default"><i class="fa fa-fw fa-plus"></i> {{ 'site.add_site'|trans({}, 'KRSolutionsKRCMSBundle') }}</a>
		</div>
	</div>
{% endblock %}

{% block content %}
	<div class="col-md-12">
		<div class="well">
			<table id="sites_table" class="table table-striped">
				<thead>
					<tr>
						<th style="width: 20%;">{{ 'site.title'|trans({}, 'KRSolutionsKRCMSBundle') }}</th>
						<th>{{ 'site.permalink'|trans({}, 'KRSolutionsKRCMSBundle') }}</th>
						<th>{{ 'site.is_active'|trans({}, 'KRSolutionsKRCMSBundle') }}</th>
						<th>{{ 'site.homepage'|trans({}, 'KRSolutionsKRCMSBundle') }}</th>
						<th></th>
					</tr>
				</thead>

				<tbody>
					{% if sites|length > 0 %}
						{% for site in sites %}
							<tr>
								<td><a href="{{ path('kr_solutions_krcms_sites_edit', { 'siteId': site.id }) }}" title="{{ 'site.edit_site'|trans({}, 'KRSolutionsKRCMSBundle') }}"><b>{{ site.title }}</b></a></td>
								<td>{{ site.permalink }}</td>
								<td>{% if site.isActive %}{{ 'layout.yes'|trans({}, 'KRSolutionsKRCMSBundle') }}{% else %}{{ 'layout.no'|trans({}, 'KRSolutionsKRCMSBundle') }}{% endif %}</td>
								<td>{% if site.homepage is not null %}{{ site.homepage.title }}{% else %}-{% endif %}</td>
								<td>
									<div class="btn-group pull-right" role="group">
										<a class="btn btn-default" href="{{ path('kr_solutions_krcms_sites_edit', { 'siteId': site.id }) }}" title="{{ 'site.edit_site'|trans({}, 'KRSolutionsKRCMSBundle') }}"><i class="fa fa-fw fa-edit"></i> {{ 'layout.edit'|trans({}, 'KRSolutionsKRCMSBundle') }}</a>
										<button type="button" class="btn btn-default" data-toggle="modal" data-target="#site_remove_modal" data-site_id="{{ site.id }}" title="{{ 'site.remove_site'|trans({}, 'KRSolutionsKRCMSBundle') }}"><i class="fa fa-fw fa-trash"></i> {{ 'layout.remove'|trans({}, 'KRSolutionsKRCMSBundle') }}</button>
									</div>
								</td>
							</tr>
						{% endfor %}
					{% else %}
						<tr>
							<td colspan="4">{{ 'sites.no_sites_added'|trans({}, 'KRSolutionsKRCMSBundle') }}</td>
							<td><a class="btn btn-default" href="{{ path('kr_solutions_krcms_sites_add') }}"><i class="fa fa-fw fa-plus"></i> {{ 'site.add_site'|trans({}, 'KRSolutionsKRCMSBundle') }}</a></td>
						</tr>
					{% endif %}
				</tbody>
			</table>
		</div>
	</div>

	{# Modals #}
	<div class="modal fade" id="site_remove_modal" tabindex="-1" role="dialog" aria-labelledby="site_remove_modal_title" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<h4 class="modal-title" id="site_remove_modal_title">{{ 'site.remove_site'|trans({}, 'KRSolutionsKRCMSBundle') }}</h4>
				</div>
				<div class="modal-body">
					<p>{{ 'site.remove_confirmation.title'|trans({}, 'KRSolutionsKRCMSBundle') }}</p>
					<p><small>{{ 'site.remove_confirmation.message'|trans({}, 'KRSolutionsKRCMSBundle') }}</small></p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">{{ 'layout.cancel'|trans({}, 'KRSolutionsKRCMSBundle') }}</button>
					<a href="#" type="button" class="btn btn-primary site_remove_action">{{ 'layout.remove'|trans({}, 'KRSolutionsKRCMSBundle') }}</a>
				</div>
			</div>
		</div>
	</div>
	{# End modals #}

{% endblock %}

{% block javascripts %}
	{{ parent() }}
	<script type="text/javascript">
		$(document).ready(function () {
			$('#site_remove_modal').on('show.bs.modal', function (event) {
				var button = $(event.relatedTarget);
				var siteId = button.data('site_id');
				var remove_url_holder = '{{ path('kr_solutions_krcms_sites_remove', {'siteId': 0}) }}';

				var modal = $(this);
				modal.find('.site_remove_action').attr('href', remove_url_holder.replace('0', siteId));
			});
		});
	</script>
{% endblock %}